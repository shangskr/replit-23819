import{a as A,aI as M,_ as F,bl as H,b as C,N as _,p as G,bm as a,P as u,bn as j,bo as I,n as L,ah as S}from"./index.70e78c9e.js";import{l as U,f as B}from"./api.7b052662.js";const D=(t,...r)=>{},m=new Map,Q=(t,r)=>{m.set(t,r)},E=t=>{window.scroll({top:m.get(t)||0,behavior:"smooth"}),D("recoverScroll",t,m.get(t))};let d;function N(t,r,n="replaceState"){let l=n==="location"?location.href:location.hash;if(!l.includes("?"))l=`${l}?${t}=${r}`;else if(!l.includes(t))l=`${l}&${t}=${r}`;else{const f=`(\\?|&|#)${t}([^&|^#]*)(&|$|#)`;l=l.replace(new RegExp(f),"$1"+t+"="+r+"$3")}n==="location"&&(location.href=l),n==="pushState"&&history.pushState({},"",l),n==="replaceState"&&history.replaceState({},"",l)}function z(t){for(var r=window.location.search.substring(1),n=r.split("&"),l=0;l<n.length;l++){var f=n[l].split("=");if(f[0]==t)return f[1]}return""}const b={};let i=1;const W=()=>i,q=()=>{const t=H();i=1,t.type==="pagination"&&N("page",1),console.log("resetGlobalPage",i)},J=()=>{const{pathname:t}=A(),[,r]=M(e=>U(e,F())),n=H();n.type==="pagination"&&z("page")&&(i=parseInt(z("page")));const[,l]=M(e=>{const s={index:e==null?void 0:e.index,size:e==null?void 0:e.size};return B(e==null?void 0:e.path,F(),s.index,s.size,e==null?void 0:e.force,new C.CancelToken(function(c){d=c}))}),f=(e,s=!0,o=!1)=>{o&&(e=G(t(),e)),s?b[e]=!0:delete b[e]};let w=!1;const g=(e,s,o)=>{d==null||d(),w=s!=null?s:!1,v(""),b[e]?p(e,i,void 0,void 0,o):O(e)},O=async e=>{a.setState(u.FetchingObj);const s=await r(e);j(s,o=>{var c;a.setObj(o),a.setProvider(o.provider),o.is_dir?(f(e),p(e,i)):(a.setReadme(o.readme),a.setHeader(o.header),a.setRelated((c=o.related)!=null?c:[]),a.setRawUrl(o.raw_url),a.setState(u.File))},v)},p=async(e,s,o,c=!1,$)=>{o||(o=n.size),o!==void 0&&n.type==="all"&&(o=void 0),i=s!=null?s:1,a.setState(c?u.FetchingMore:u.FetchingObjs);const y=await l({path:e,index:s,size:o,force:$});j(y,h=>{var R;c?I(h.content):(a.setObjs((R=h.content)!=null?R:[]),a.setTotal(h.total)),a.setReadme(h.readme),a.setHeader(h.header),a.setWrite(h.write),a.setProvider(h.provider),a.setState(u.Folder),c&&(s!=null?s:1)>1||E(e)},v)},v=(e,s)=>{s===403?(a.setState(u.NeedPassword),w&&L.error(e)):a.setErr(e)},P=(e,s,o=!1)=>{p(t(),e,s,o)};return{handlePathChange:g,setPathAs:f,refresh:(e,s)=>{g(t(),e,s)},pageChange:P,loadMore:()=>{P(i+1,void 0,!0)},allLoaded:()=>i>=Math.ceil(_.total/n.size)}};function x(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M16 2l5 5v14.008a.993.993 0 01-.993.992H3.993A1 1 0 013 21.008V2.992C3 2.444 3.445 2 3.993 2H16zm-3 10h3l-4-4-4 4h3v4h2v-4z"/>'},t)}function K(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M12.414 5H21a1 1 0 011 1v14a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1h7.414l2 2zM13 13h3l-4-4-4 4h3v4h2v-4z"/>'},t)}function X(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M5.463 4.433A9.961 9.961 0 0112 2c5.523 0 10 4.477 10 10 0 2.136-.67 4.116-1.81 5.74L17 12h3A8 8 0 006.46 6.228l-.997-1.795zm13.074 15.134A9.961 9.961 0 0112 22C6.477 22 2 17.523 2 12c0-2.136.67-4.116 1.81-5.74L7 12H4a8 8 0 0013.54 5.772l.997 1.795z"/>'},t)}export{X as R,q as a,E as b,K as c,x as d,N as e,W as g,Q as r,J as u};
